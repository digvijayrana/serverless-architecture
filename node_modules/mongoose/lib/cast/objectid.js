'use strict';

<<<<<<< HEAD
const isBsonType = require('../helpers/isBsonType');
const ObjectId = require('../types/objectid');
=======
const ObjectId = require('../driver').get().ObjectId;
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d

module.exports = function castObjectId(value) {
  if (value == null) {
    return value;
  }

<<<<<<< HEAD
  if (isBsonType(value, 'ObjectId')) {
=======
  if (value instanceof ObjectId) {
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
    return value;
  }

  if (value._id) {
<<<<<<< HEAD
    if (isBsonType(value._id, 'ObjectId')) {
=======
    if (value._id instanceof ObjectId) {
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      return value._id;
    }
    if (value._id.toString instanceof Function) {
      return new ObjectId(value._id.toString());
    }
  }

  if (value.toString instanceof Function) {
    return new ObjectId(value.toString());
  }

  return new ObjectId(value);
<<<<<<< HEAD
};
=======
};
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
