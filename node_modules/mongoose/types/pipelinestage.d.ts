declare module 'mongoose' {
  /**
<<<<<<< HEAD
     * [Stages reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation-pipeline/#aggregation-pipeline-stages)
     */
  export type PipelineStage =
    | PipelineStage.AddFields
    | PipelineStage.Bucket
    | PipelineStage.BucketAuto
    | PipelineStage.CollStats
    | PipelineStage.Count
    | PipelineStage.Densify
    | PipelineStage.Facet
    | PipelineStage.Fill
    | PipelineStage.GeoNear
    | PipelineStage.GraphLookup
    | PipelineStage.Group
    | PipelineStage.IndexStats
    | PipelineStage.Limit
    | PipelineStage.ListSessions
    | PipelineStage.Lookup
    | PipelineStage.Match
    | PipelineStage.Merge
    | PipelineStage.Out
    | PipelineStage.PlanCacheStats
    | PipelineStage.Project
    | PipelineStage.Redact
    | PipelineStage.ReplaceRoot
    | PipelineStage.ReplaceWith
    | PipelineStage.Sample
    | PipelineStage.Search
    | PipelineStage.Set
    | PipelineStage.SetWindowFields
    | PipelineStage.Skip
    | PipelineStage.Sort
    | PipelineStage.SortByCount
    | PipelineStage.UnionWith
    | PipelineStage.Unset
    | PipelineStage.Unwind;

  export namespace PipelineStage {
    export interface AddFields {
      /** [`$addFields` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/addFields/) */
      $addFields: Record<string, AnyExpression>
    }

    export interface Bucket {
      /** [`$bucket` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/bucket/) */
      $bucket: {
        groupBy: Expression;
        boundaries: any[];
        default?: any
        output?: Record<string, AccumulatorOperator>
=======
     * [Stages reference](https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/#aggregation-pipeline-stages)
     */
  export type PipelineStage =
      | PipelineStage.AddFields
      | PipelineStage.Bucket
      | PipelineStage.BucketAuto
      | PipelineStage.CollStats
      | PipelineStage.Count
      | PipelineStage.Facet
      | PipelineStage.GeoNear
      | PipelineStage.GraphLookup
      | PipelineStage.Group
      | PipelineStage.IndexStats
      | PipelineStage.Limit
      | PipelineStage.ListSessions
      | PipelineStage.Lookup
      | PipelineStage.Match
      | PipelineStage.Merge
      | PipelineStage.Out
      | PipelineStage.PlanCacheStats
      | PipelineStage.Project
      | PipelineStage.Redact
      | PipelineStage.ReplaceRoot
      | PipelineStage.ReplaceWith
      | PipelineStage.Sample
      | PipelineStage.Search
      | PipelineStage.Set
      | PipelineStage.SetWindowFields
      | PipelineStage.Skip
      | PipelineStage.Sort
      | PipelineStage.SortByCount
      | PipelineStage.UnionWith
      | PipelineStage.Unset
      | PipelineStage.Unwind;

  export namespace PipelineStage {
    export interface AddFields {
      /** [`$addFields` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/addFields/) */
      $addFields: Record<string, any>
    }

    export interface Bucket {
      /** [`$bucket` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/bucket/) */
      $bucket: {
        groupBy: any
        boundaries: any[]
        default?: any
        output?: Record<string, { [op in AccumulatorOperator]?: any }>
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface BucketAuto {
<<<<<<< HEAD
      /** [`$bucketAuto` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/bucketAuto/) */
      $bucketAuto: {
        groupBy: Expression | Record<string, Expression>;
        buckets: number;
        output?: Record<string, AccumulatorOperator>;
        granularity?: 'R5' | 'R10' | 'R20' | 'R40' | 'R80' | '1-2-5' | 'E6' | 'E12' | 'E24' | 'E48' | 'E96' | 'E192' | 'POWERSOF2';
=======
      /** [`$bucketAuto` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/bucketAuto/) */
      $bucketAuto: {
        groupBy: any
        buckets: number
        output?: Record<string, { [op in AccumulatorOperator]?: any }>
        granularity?: 'R5' | 'R10' | 'R20' | 'R40' | 'R80' | '1-2-5' | 'E6' | 'E12' | 'E24' | 'E48' | 'E96' | 'E192' | 'POWERSOF2'
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface CollStats {
<<<<<<< HEAD
      /** [`$collStats` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/collStats/) */
      $collStats: {
        latencyStats?: { histograms?: boolean };
        storageStats?: { scale?: number };
        count?: Record<string | number | symbol, never>;
        queryExecStats?: Record<string | number | symbol, never>;
=======
      /** [`$collStats` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/collStats/) */
      $collStats: {
        latencyStats?: { histograms?: boolean }
        storageStats?: { scale?: number }
        count?: {}
        queryExecStats?: {}
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface Count {
<<<<<<< HEAD
      /** [`$count` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/count/) */
      $count: string;
    }

    export interface Densify{
      /** [`$densify` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/densify/) */
      $densify: {
        field: string,
        partitionByFields?: string[],
        range: {
          step: number,
          unit?: 'millisecond' | 'second' | 'minute' | 'hour' | 'day' | 'week' | 'month' | 'quarter' | 'year',
          bounds: number[] | globalThis.Date[] | 'full' | 'partition'
        }
      }
    }

    export interface Fill {
      /** [`$fill` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/fill/) */
      $fill: {
        partitionBy?: Expression,
        partitionByFields?: string[],
        sortBy?: Record<string, 1 | -1>,
        output: Record<string, { value: Expression } | { method: 'linear' | 'locf' }>
      }
    }

    export interface Facet {
      /** [`$facet` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/facet/) */
      $facet: Record<string, FacetPipelineStage[]>;
=======
      /** [`$count` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/count/) */
      $count: string
    }

    export interface Facet {
      /** [`$facet` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/facet/) */
      $facet: Record<string, FacetPipelineStage[]>
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
    }

    export type FacetPipelineStage = Exclude<PipelineStage, PipelineStage.CollStats | PipelineStage.Facet | PipelineStage.GeoNear | PipelineStage.IndexStats | PipelineStage.Out | PipelineStage.Merge | PipelineStage.PlanCacheStats>;

    export interface GeoNear {
<<<<<<< HEAD
      /** [`$geoNear` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/geoNear/) */
      $geoNear: {
        near: { type: 'Point'; coordinates: [number, number] } | [number, number];
        distanceField: string;
        distanceMultiplier?: number;
        includeLocs?: string;
        key?: string;
        maxDistance?: number;
        minDistance?: number;
        query?: AnyObject;
        spherical?: boolean;
        /**
         * Deprecated. Use only with MondoDB below 4.2 (removed in 4.2)
         * @deprecated
         */
        num?: number;
=======
      /** [`$geoNear` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/geoNear/) */
      $geoNear: {
        near: { type: 'Point'; coordinates: [number, number] } | [number, number]
        distanceField: string
        distanceMultiplier?: number
        includeLocs?: string
        key?: string
        maxDistance?: number
        minDistance?: number
        query?: AnyObject
        spherical?: boolean
        uniqueDocs?: boolean
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface GraphLookup {
<<<<<<< HEAD
      /** [`$graphLookup` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/graphLookup/) */
      $graphLookup: {
        from: string;
        startWith: any
        connectFromField: string;
        connectToField: string;
        as: string;
        maxDepth?: number;
        depthField?: string;
        restrictSearchWithMatch?: AnyObject;
=======
      /** [`$graphLookup` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/graphLookup/) */
      $graphLookup: {
        from: string
        startWith: any
        connectFromField: string
        connectToField: string
        as: string
        maxDepth?: number
        depthField?: string
        restrictSearchWithMatch?: AnyObject
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface Group {
<<<<<<< HEAD
      /** [`$group` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/group) */
      $group: { _id: any } | { [key: string]: AccumulatorOperator }
    }

    export interface IndexStats {
      /** [`$indexStats` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/indexStats/) */
      $indexStats: Record<string | number | symbol, never>;
    }

    export interface Limit {
      /** [`$limit` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/limit/) */
=======
      /** [`$group` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/group) */
      $group: { _id: any } | { [key: string]: { [op in AccumulatorOperator]?: any } }
    }

    export interface IndexStats {
      /** [`$indexStats` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/indexStats/) */
      $indexStats: {}
    }

    export interface Limit {
      /** [`$limit` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/limit/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $limit: number
    }

    export interface ListSessions {
<<<<<<< HEAD
      /** [`$listSessions` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/listSessions/) */
=======
      /** [`$listSessions` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/listSessions/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $listSessions: { users?: { user: string; db: string }[] } | { allUsers?: true }
    }

    export interface Lookup {
<<<<<<< HEAD
      /** [`$lookup` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/lookup/) */
=======
      /** [`$lookup` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $lookup: {
        from: string
        as: string
        localField?: string
        foreignField?: string
        let?: Record<string, any>
<<<<<<< HEAD
        pipeline?: Exclude<PipelineStage, PipelineStage.Merge | PipelineStage.Out>[]
=======
        pipeline?: Exclude<PipelineStage, PipelineStage.Merge | PipelineStage.Out | PipelineStage.Search>[]
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface Match {
<<<<<<< HEAD
      /** [`$match` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/match/) */
      $match: FilterQuery<any>;
    }

    export interface Merge {
      /** [`$merge` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/merge/) */
      $merge: {
        into: string | { db: string; coll: string }
        on?: string | string[]
        let?: Record<string, Expression>
=======
      /** [`$match` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/match/) */
      $match: AnyObject
    }

    export interface Merge {
      /** [`$merge` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/merge/) */
      $merge: {
        into: string | { db: string; coll: string }
        on?: string | string[]
        let?: Record<string, any>
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
        whenMatched?: 'replace' | 'keepExisting' | 'merge' | 'fail' | Extract<PipelineStage, PipelineStage.AddFields | PipelineStage.Set | PipelineStage.Project | PipelineStage.Unset | PipelineStage.ReplaceRoot | PipelineStage.ReplaceWith>[]
        whenNotMatched?: 'insert' | 'discard' | 'fail'
      }
    }

    export interface Out {
<<<<<<< HEAD
      /** [`$out` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/out/) */
=======
      /** [`$out` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/out/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $out: string | { db: string; coll: string }
    }

    export interface PlanCacheStats {
<<<<<<< HEAD
      /** [`$planCacheStats` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/planCacheStats/) */
      $planCacheStats: Record<string | number | symbol, never>
    }

    export interface Project {
      /** [`$project` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/project/) */
      $project: { [field: string]: AnyExpression | Expression | Project['$project'] }
    }

    export interface Redact {
      /** [`$redact` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/redact/) */
      $redact: Expression;
    }

    export interface ReplaceRoot {
      /** [`$replaceRoot` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/replaceRoot/) */
      $replaceRoot: { newRoot: AnyExpression }
    }

    export interface ReplaceWith {
      /** [`$replaceWith` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/replaceWith/) */
      $replaceWith: ObjectExpressionOperator | { [field: string]: Expression } | `$${string}`;
    }

    export interface Sample {
      /** [`$sample` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/sample/) */
=======
      /** [`$planCacheStats` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/planCacheStats/) */
      $planCacheStats: {}
    }

    export interface Project {
      /** [`$project` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/project/) */
      $project: { [field: string]: any }
    }

    export interface Redact {
      /** [`$redact` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/redact/) */
      $redact: any
    }

    export interface ReplaceRoot {
      /** [`$replaceRoot` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/replaceRoot/) */
      $replaceRoot: { newRoot: any }
    }

    export interface ReplaceWith {
      /** [`$replaceWith` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/replaceWith/) */
      $replaceWith: any
    }

    export interface Sample {
      /** [`$sample` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/sample/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $sample: { size: number }
    }

    export interface Search {
<<<<<<< HEAD
      /** [`$search` reference](https://www.mongodb.com/docs/atlas/atlas-search/query-syntax/) */
=======
      /** [`$search` reference](https://docs.atlas.mongodb.com/reference/atlas-search/query-syntax/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $search: {
        index?: string;
        highlight?: {
          /** [`highlightPath` reference](https://docs.atlas.mongodb.com/atlas-search/path-construction/#multiple-field-search) */
          path: string | string[] | { value: string, multi: string };
          maxCharsToExamine?: number;
          maxNumPassages?: number;
        };
<<<<<<< HEAD
        [operator: string]: any;
=======
        [key: string]: any;
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      }
    }

    export interface Set {
<<<<<<< HEAD
      /** [`$set` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/set/) */
      $set: Record<string, AnyExpression | any>
    }

    export interface SetWindowFields {
      /** [`$setWindowFields` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/setWindowFields/) */
=======
      /** [`$set` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/set/) */
      $set: Record<string, any>
    }

    export interface SetWindowFields {
      /** [`$setWindowFields` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/setWindowFields/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $setWindowFields: {
        partitionBy?: any
        sortBy?: Record<string, 1 | -1>
        output: Record<
        string,
<<<<<<< HEAD
        WindowOperator & {
=======
        { [op in WindowOperator]?: any } & {
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
          window?: {
            documents?: [string | number, string | number]
            range?: [string | number, string | number]
            unit?: 'year' | 'quarter' | 'month' | 'week' | 'day' | 'hour' | 'minute' | 'second' | 'millisecond'
          }
        }
        >
      }
    }

    export interface Skip {
<<<<<<< HEAD
      /** [`$skip` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/skip/) */
=======
      /** [`$skip` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/skip/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $skip: number
    }

    export interface Sort {
<<<<<<< HEAD
      /** [`$sort` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/sort/) */
      $sort: Record<string, 1 | -1 | Expression.Meta>
    }

    export interface SortByCount {
      /** [`$sortByCount` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/sortByCount/) */
      $sortByCount: Expression;
    }

    export interface UnionWith {
      /** [`$unionWith` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/unionWith/) */
=======
      /** [`$sort` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/sort/) */
      $sort: Record<string, 1 | -1 | { $meta: 'textScore' }>
    }

    export interface SortByCount {
      /** [`$sortByCount` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/sortByCount/) */
      $sortByCount: any
    }

    export interface UnionWith {
      /** [`$unionWith` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/unionWith/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $unionWith:
      | string
      | { coll: string; pipeline?: Exclude<PipelineStage, PipelineStage.Out | PipelineStage.Merge>[] }
    }

    export interface Unset {
<<<<<<< HEAD
      /** [`$unset` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/unset/) */
=======
      /** [`$unset` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/unset/) */
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
      $unset: string | string[]
    }

    export interface Unwind {
<<<<<<< HEAD
      /** [`$unwind` reference](https://www.mongodb.com/docs/manual/reference/operator/aggregation/unwind/) */
      $unwind: string | { path: string; includeArrayIndex?: string; preserveNullAndEmptyArrays?: boolean }
    }
=======
      /** [`$unwind` reference](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/) */
      $unwind: string | { path: string; includeArrayIndex?: string; preserveNullAndEmptyArrays?: boolean }
    }

      type AccumulatorOperator = '$accumulator' | '$addToSet' | '$avg' | '$count' | '$first' | '$last' | '$max' | '$mergeObjects' | '$min' | '$push' | '$stdDevPop' | '$stdDevSamp' | '$sum';

      type WindowOperator = '$addToSet' | '$avg' | '$count' | '$covariancePop' | '$covarianceSamp' | '$derivative' | '$expMovingAvg' | '$integral' | '$max' | '$min' | '$push' | '$stdDevSamp' | '$stdDevPop' | '$sum' | '$first' | '$last' | '$shift' | '$denseRank' | '$documentNumber' | '$rank';
>>>>>>> fd4215aa5028bc75f532153c8e97a44d89c0c47d
  }
}
